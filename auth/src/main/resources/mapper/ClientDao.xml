<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gaotianchi.auth.dao.ClientDao">

    <resultMap type="com.gaotianchi.auth.entity.Client" id="ClientMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="clientId" column="client_id" jdbcType="VARCHAR"/>
        <result property="clientIdIssuedAt" column="client_id_issued_at" jdbcType="TIMESTAMP"/>
        <result property="clientName" column="client_name" jdbcType="VARCHAR"/>
        <result property="clientAuthenticationMethods" column="client_authentication_methods" jdbcType="VARCHAR"/>
        <result property="clientSettings" column="client_settings" jdbcType="VARCHAR"/>
        <result property="tokenSettings" column="token_settings" jdbcType="VARCHAR"/>
        <result property="authorizationGrantTypes" column="authorization_grant_types" jdbcType="VARCHAR"/>
        <result property="scopes" column="scopes" jdbcType="VARCHAR"/>
        <result property="redirectUris" column="redirect_uris" jdbcType="VARCHAR"/>
        <result property="clientSecret" column="client_secret" jdbcType="VARCHAR"/>
        <result property="clientSecretIssuedAt" column="client_secret_issued_at" jdbcType="TIMESTAMP"/>
        <result property="postLogoutRedirectUris" column="post_logout_redirect_uris" jdbcType="VARCHAR"/>
    </resultMap>

    <!--查询单个-->
    <select id="selectById" resultMap="ClientMap">
        SELECT id,
               client_id,
               client_id_issued_at,
               client_name,
               client_authentication_methods,
               client_settings,
               token_settings,
               authorization_grant_types,
               scopes,
               redirect_uris,
               client_secret,
               client_secret_issued_at,
               post_logout_redirect_uris
        FROM client
        WHERE id = #{id}
    </select>

    <select id="selectByClientId" resultMap="ClientMap">
        SELECT id,
               client_id,
               client_id_issued_at,
               client_name,
               client_authentication_methods,
               client_settings,
               token_settings,
               authorization_grant_types,
               scopes,
               redirect_uris,
               client_secret,
               client_secret_issued_at,
               post_logout_redirect_uris
        FROM client
        WHERE client_id = #{clientId}
    </select>

    <!--查询指定行数据-->
    <select id="selectByPage" resultMap="ClientMap">
        SELECT
        id, client_id, client_id_issued_at, client_name, client_authentication_methods, client_settings, token_settings,
        authorization_grant_types, scopes, redirect_uris, client_secret, client_secret_issued_at,
        post_logout_redirect_uris
        FROM client
        <where>
            <if test="id != null">
                AND id = #{id}
            </if>
            <if test="clientId != null and clientId != ''">
                AND client_id = #{clientId}
            </if>
            <if test="clientIdIssuedAt != null">
                AND client_id_issued_at = #{clientIdIssuedAt}
            </if>
            <if test="clientName != null and clientName != ''">
                AND client_name = #{clientName}
            </if>
            <if test="clientAuthenticationMethods != null and clientAuthenticationMethods != ''">
                AND client_authentication_methods = #{clientAuthenticationMethods}
            </if>
            <if test="clientSettings != null and clientSettings != ''">
                AND client_settings = #{clientSettings}
            </if>
            <if test="tokenSettings != null and tokenSettings != ''">
                AND token_settings = #{tokenSettings}
            </if>
            <if test="authorizationGrantTypes != null and authorizationGrantTypes != ''">
                AND authorization_grant_types = #{authorizationGrantTypes}
            </if>
            <if test="scopes != null and scopes != ''">
                AND scopes = #{scopes}
            </if>
            <if test="redirectUris != null and redirectUris != ''">
                AND redirect_uris = #{redirectUris}
            </if>
            <if test="clientSecret != null and clientSecret != ''">
                AND client_secret = #{clientSecret}
            </if>
            <if test="clientSecretIssuedAt != null">
                AND client_secret_issued_at = #{clientSecretIssuedAt}
            </if>
            <if test="postLogoutRedirectUris != null and postLogoutRedirectUris != ''">
                AND post_logout_redirect_uris = #{postLogoutRedirectUris}
            </if>
        </where>
        LIMIT #{pageable.offset}, #{pageable.pageSize}
    </select>

    <!--统计总行数-->
    <select id="count" resultType="java.lang.Long">
        SELECT count(1)
        FROM client
        <where>
            <if test="id != null">
                AND id = #{id}
            </if>
            <if test="clientId != null and clientId != ''">
                AND client_id = #{clientId}
            </if>
            <if test="clientIdIssuedAt != null">
                AND client_id_issued_at = #{clientIdIssuedAt}
            </if>
            <if test="clientName != null and clientName != ''">
                AND client_name = #{clientName}
            </if>
            <if test="clientAuthenticationMethods != null and clientAuthenticationMethods != ''">
                AND client_authentication_methods = #{clientAuthenticationMethods}
            </if>
            <if test="clientSettings != null and clientSettings != ''">
                AND client_settings = #{clientSettings}
            </if>
            <if test="tokenSettings != null and tokenSettings != ''">
                AND token_settings = #{tokenSettings}
            </if>
            <if test="authorizationGrantTypes != null and authorizationGrantTypes != ''">
                AND authorization_grant_types = #{authorizationGrantTypes}
            </if>
            <if test="scopes != null and scopes != ''">
                AND scopes = #{scopes}
            </if>
            <if test="redirectUris != null and redirectUris != ''">
                AND redirect_uris = #{redirectUris}
            </if>
            <if test="clientSecret != null and clientSecret != ''">
                AND client_secret = #{clientSecret}
            </if>
            <if test="clientSecretIssuedAt != null">
                AND client_secret_issued_at = #{clientSecretIssuedAt}
            </if>
            <if test="postLogoutRedirectUris != null and postLogoutRedirectUris != ''">
                AND post_logout_redirect_uris = #{postLogoutRedirectUris}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO client(client_id, client_id_issued_at, client_name, client_authentication_methods, client_settings,
                           token_settings, authorization_grant_types, scopes, redirect_uris, client_secret,
                           client_secret_issued_at, post_logout_redirect_uris)
        VALUES (#{clientId}, #{clientIdIssuedAt}, #{clientName}, #{clientAuthenticationMethods}, #{clientSettings},
                #{tokenSettings}, #{authorizationGrantTypes}, #{scopes}, #{redirectUris}, #{clientSecret},
                #{clientSecretIssuedAt}, #{postLogoutRedirectUris})
    </insert>

    <insert id="insertBatch" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO client(client_id, client_id_issued_at, client_name, client_authentication_methods, client_settings,
        token_settings, authorization_grant_types, scopes, redirect_uris, client_secret, client_secret_issued_at,
        post_logout_redirect_uris)
        VALUES
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.clientId}, #{entity.clientIdIssuedAt}, #{entity.clientName},
            #{entity.clientAuthenticationMethods}, #{entity.clientSettings}, #{entity.tokenSettings},
            #{entity.authorizationGrantTypes}, #{entity.scopes}, #{entity.redirectUris}, #{entity.clientSecret},
            #{entity.clientSecretIssuedAt}, #{entity.postLogoutRedirectUris})
        </foreach>
    </insert>

    <insert id="insertOrUpdateBatch" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO client(client_id, client_id_issued_at, client_name, client_authentication_methods, client_settings,
        token_settings, authorization_grant_types, scopes, redirect_uris, client_secret, client_secret_issued_at,
        post_logout_redirect_uris)
        VALUES
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.clientId}, #{entity.clientIdIssuedAt}, #{entity.clientName},
            #{entity.clientAuthenticationMethods}, #{entity.clientSettings}, #{entity.tokenSettings},
            #{entity.authorizationGrantTypes}, #{entity.scopes}, #{entity.redirectUris}, #{entity.clientSecret},
            #{entity.clientSecretIssuedAt}, #{entity.postLogoutRedirectUris})
        </foreach>
        ON DUPLICATE KEY UPDATE
        client_id = values(client_id),
        client_id_issued_at = values(client_id_issued_at),
        client_name = values(client_name),
        client_authentication_methods = values(client_authentication_methods),
        client_settings = values(client_settings),
        token_settings = values(token_settings),
        authorization_grant_types = values(authorization_grant_types),
        scopes = values(scopes),
        redirect_uris = values(redirect_uris),
        client_secret = values(client_secret),
        client_secret_issued_at = values(client_secret_issued_at),
        post_logout_redirect_uris = values(post_logout_redirect_uris)
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        UPDATE client
        <set>
            <if test="clientId != null and clientId != ''">
                client_id = #{clientId},
            </if>
            <if test="clientIdIssuedAt != null">
                client_id_issued_at = #{clientIdIssuedAt},
            </if>
            <if test="clientName != null and clientName != ''">
                client_name = #{clientName},
            </if>
            <if test="clientAuthenticationMethods != null and clientAuthenticationMethods != ''">
                client_authentication_methods = #{clientAuthenticationMethods},
            </if>
            <if test="clientSettings != null and clientSettings != ''">
                client_settings = #{clientSettings},
            </if>
            <if test="tokenSettings != null and tokenSettings != ''">
                token_settings = #{tokenSettings},
            </if>
            <if test="authorizationGrantTypes != null and authorizationGrantTypes != ''">
                authorization_grant_types = #{authorizationGrantTypes},
            </if>
            <if test="scopes != null and scopes != ''">
                scopes = #{scopes},
            </if>
            <if test="redirectUris != null and redirectUris != ''">
                redirect_uris = #{redirectUris},
            </if>
            <if test="clientSecret != null and clientSecret != ''">
                client_secret = #{clientSecret},
            </if>
            <if test="clientSecretIssuedAt != null">
                client_secret_issued_at = #{clientSecretIssuedAt},
            </if>
            <if test="postLogoutRedirectUris != null and postLogoutRedirectUris != ''">
                post_logout_redirect_uris = #{postLogoutRedirectUris},
            </if>
        </set>
        WHERE id = #{id}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        DELETE
        FROM client
        where id = #{id}
    </delete>

</mapper>

